--- Python-2.7.2/configure.in.orig	2012-11-01 19:09:33.586433845 +0100
+++ Python-2.7.2/configure.in	2012-11-01 19:10:26.390692009 +0100
@@ -3611,15 +3611,13 @@
 #include <semaphore.h>
 #include <sys/stat.h>
 
-int main(void) {
-  sem_t *a = sem_open("/autoconf", O_CREAT, S_IRUSR|S_IWUSR, 0);
-  if (a == SEM_FAILED) {
-    perror("sem_open");
-    return 1;
-  }
-  sem_close(a);
-  sem_unlink("/autoconf");
-  return 0;
+int main(void){
+    sem_t a;
+    sem_init(&a, PTHREAD_PROCESS_PRIVATE, 0);
+    int count;
+    int res;
+    res = sem_getvalue(&a, &count);
+    return res==-1 ? 1 : 0;
 }
 ]])],
 [ac_cv_posix_semaphores_enabled=yes],
@@ -3644,18 +3642,12 @@
 #include <sys/stat.h>
 
 int main(void){
-  sem_t *a = sem_open("/autocftw", O_CREAT, S_IRUSR|S_IWUSR, 0);
-  int count;
-  int res;
-  if(a==SEM_FAILED){
-    perror("sem_open");
-    return 1;
-
-  }
-  res = sem_getvalue(a, &count);
-  sem_close(a);
-  sem_unlink("/autocftw");
-  return res==-1 ? 1 : 0;
+    sem_t a;
+    sem_init(&a, PTHREAD_PROCESS_PRIVATE, 0);
+    int count;
+    int res;
+    res = sem_getvalue(&a, &count);
+    return res==-1 ? 1 : 0;
 }
 ]])],
 [ac_cv_broken_sem_getvalue=no],
